@model CitizenPortalLib.PortalViewModel.LoginModel

@{
    ViewBag.Title = "Index";
}
<script src="~/Sambalpur/js/jquery-2.2.3.min.js" type="text/javascript"></script>
@*<script src="~/g2c/js/jquery.min.js"></script>*@
<script type="text/javascript">
    function DisableHistory() {
        window.history.forward(1);
    }
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#showLogin').hide();

        $("#rgstrUser").click(function () {
            $("#showLogin").show('');
            $("#allUserType").hide('');
        });
        $("#backuser").click(function () {
            $("#showLogin").hide('');
            $("#allUserType").show('');
        });
    });
</script>
@*@Styles.Render("~/Content/css")
    @Styles.Render("~/Content/Portal/css")*@
<style type="text/css">
    h1 {
        margin: 0;
    }


    hr {
        margin: 0;
        padding: 0;
        clear: both;
        border: none;
    }

    #container_lgn {
        /*width: 512px;*/
    }

    #btnlogin {
        background-color: #ff9800 !important;
        border: 1px solid #EC8D00;
        font-size: 15px;
    }

    .mleft40 {
        margin-left: 50px !important;
    }

    .login-wrapper {
        width: 550px;
        margin: 0 auto;
    }

    .rbt-grp {
        padding-left: 0;
    }

    .text-align-center {
        text-align: center;
    }

    .Ltitle {
        font-weight: bolder;
        color: rgb(233, 84, 0);
    }

    .sub-title {
        color: rgb(0, 62, 0);
        margin: 2px;
        font-size: 15px;
        font-weight: bold;
        text-transform: uppercase;
    }

    .sub-sub-title {
        color: rgb(0, 29, 0);
        margin-bottom: 10px;
        font-size: 15px;
        font-weight: bold;
        letter-spacing: 1.2px;
    }

    .btm_logo {
        width: auto !important;
        text-align: right;
    }

    input {
        background: #fff;
        line-height: 32px !important;
        border: 1px solid #c4c4c4;
        padding: 0 7px;
        padding: 0 8px 0 8px;
        border-radius: 4px;
        -moz-border-radius: 4px;
        -webkit-border-radius: 4px;
    }

    .box-container > .box-body {
        background-color: rgba(255, 255, 255, 0.8) !important;
    }


    .button {
        display: inline-block;
        border-radius: 4px;
        background-color: #f4511e;
        border: none;
        color: #FFFFFF;
        text-align: center;
        font-size: 14px;
        padding: 12px 3px;
        width: 100%;
        /*min-height:48px;*/
        transition: all 0.5s;
        cursor: pointer;
        margin: 5px 5px 20px 5px;
        -webkit-box-shadow: -1px 6px 10px 0px rgba(50, 50, 50, 0.25);
        -moz-box-shadow: -1px 6px 10px 0px rgba(50, 50, 50, 0.25);
        box-shadow: -1px 6px 10px 0px rgba(50, 50, 50, 0.25);
    }

        .button span {
            cursor: pointer;
            display: inline-block;
            position: relative;
            transition: 0.5s;
        }

            .button span:after {
                content: '>>';
                position: absolute;
                opacity: 0;
                top: 0;
                right: -20px;
                transition: 0.5s;
            }

        .button:hover span {
            padding-right: 25px;
        }

            .button:hover span:after {
                opacity: 1;
                right: 0;
            }
</style>
<link href="~/Sambalpur/css/bootstrap.min.css" type="text/css" rel="stylesheet" />
<link href="~/Sambalpur/css/font-awesome.min.css" type="text/css" rel="stylesheet" />
<link href="~/Sambalpur/css/homestyle.css" type="text/css" rel="stylesheet" />
@*<link href="~/g2c/css/hmepge.bootstrap.css" rel="stylesheet" />*@
@*<link href="~/g2c/css/style.css" rel="stylesheet" />*@
@*<link href="~/g2c/css/responsive_media.css" rel="stylesheet" />*@
<script type="text/javascript" src="~/Scripts/md5.js"></script>
@*<link href="~/WebApp/Styles/style.admin.css" rel="stylesheet" />*@
<script src="~/Sambalpur/js/SHA256.js"></script>
<script language="javascript">
    var salt = '@Session["SaltKey"]';
</script>
<body>
    <form id="loginForm" action='@Url.Action("Login")' autocomplete="off" method="post" novalidate>
        @*Start Header*@
        <header>
            <div class="container-fluid whitebg myheader">
                <div class="row tophead">
                    <div class="col-xs-12 col-sm-3 col-md-1 col-lg-1">
                        <img src="~/PortalImages/MPLogo.png" class="img-responsive small-view" width="141" height="124" alt="Maharshi Patanjali Sanskrit Sansthan, Bhopal" />
                    </div>
                    <div class="col-xs-12 col-sm-9 col-md-5 col-lg-6 logo">
                        <h2 style="margin: 10px auto; font-size: 23px; font-weight: bolder">MAHARSHI PATANJALI SANSKRIT SANSTHAN</h2>
                        <h2 style="margin:10px auto;font-size:25px;font-weight:bolder">महर्षि पतंजलि संस्कृत संस्थान, भोपाल</h2>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-6 col-lg-5 common-nav text-right ptop20">
                        <a href="~/mpss/mpss/index.html" class="navtop-homebtn"><i class="fa fa-home fa-fw"></i>Home</a>


                    </div>
                </div>

            </div>
        </header>
        @*End Header*@
        <section class="main-content">
            <div class="" id="container_lgn" style="margin-top: 12px;">

                <div class="">
                    <div class="login-wrapper box-container" style="margin:80px auto;" id="allUserType">
                        <div class="box-heading">
                            <h4 class="box-title">
                                <i class="fa fa-sign-in fa-fw"></i> SELECT LOGIN TYPE
                            </h4>

                        </div>
                        <div class="box-body box-body-open" style="padding: 40px 5px;">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6" style="display:none;">
                                <a href="~/WebApp/Registration/CitizenRegistration.aspx?SvcID=995" class="btn-success button"><i class="fa fa-user fa-3x fa-fw pbottom5"></i><br />New Student Registration</a>
                            </div>
                            <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                <a href="#" onclick="return DispLoginPanel('C');" class="btn-info button" id="rgstrUser" title="Student Login (already registered student)">
                                    <i class="fa fa-group fa-3x fa-fw pbottom5"></i><br />Student Login
                                </a>
                                @*<a href="~/WebApp/Entrance/Login/Login.aspx" class="btn-info button" id="rgstrUser"><i class="fa fa-group fa-3x fa-fw pbottom5"></i><br />Student Login</a>*@
                            </div>
                            @*<div class="mtop40"></div>
                                <div class="clearfix"></div>*@
                            <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                <a href="#" onclick="return DispLoginPanel('D');" class="btn-warning button" title="Department Login">
                                    <i class="fa fa-university fa-3x fa-fw pbottom5"></i><br />Department Login
                                </a>
                            </div>
                            @*<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6" style="">
                                    <a id="btncscConnect" href="~/WebApp/Entrance/Login/Login.aspx" name="CSCsubmit" class="btn-primary button" title="Candidate Appearing for Entrance Examination">
                                        <i class="fa fa-graduation-cap fa-3x fa-fw pbottom5"></i><br />
                                        <input type="submit" id="btnCSC" name="CSCsubmit" style="display:none;" class="fa fa-wheelchair fa-3x fa-fw pbottom5" value="PhD Entrance Candidate Login" />
                                        PhD. Entrance Login
                                    </a>
                                </div>
                                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6" style="">
                                    <a id="btncscConnect" href="~/WebApp/Examination/SearchStudent.aspx" name="CSCsubmit" class="btn-dark button" title="Click to Create Logi ID & Password">
                                        <i class="fa fa-pencil-square fa-3x fa-fw pbottom5"></i><br />
                                        <input type="submit" id="btnCSC" name="CSCsubmit" style="display:none;" class="fa fa-wheelchair fa-3x fa-fw pbottom5" value="Click to Create Logi ID & Password" />
                                        Unregistered Student
                                    </a>
                                </div>*@
                            <div class="clearfix"></div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                    <div class="login-wrapper box-container" id="showLogin" style="margin-top:120px;">
                        <div class="box-heading">
                            @Html.AntiForgeryToken()
                            @*@Html.HiddenFor(model => model.SaltKeyValue, new { @id = "hdnsaltkey" })*@
                            @*<input type="hidden" value="@ViewBag.SaltKeyValue" id="hdnsaltkey" name="hdnsaltkey" />
                                <input type="hidden" value="@ViewBag.SaltKeyValue" id="hdrandomSeed" name="hdrandomSeed" />*@
                            <input type="hidden" id="hdrDigitalSeva" />
                            <h4 class="box-title">
                                <i class="fa fa-sign-in"></i>    SIGN IN
                            </h4>
                        </div>
                        <div class="box-body box-body-open">

                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" id="divDec">
                                @if (ViewData["errMessage"] != null && ViewData["errMessage"].ToString() != "")
                                {
                                    <div id="divMsg" class="col-sm-12 col-md-12 col-lg-12 error form-group has-error alert alert-danger">
                                        <label id="errormsg" class="control-label">
                                            @Html.Encode(ViewData["errMessage"].ToString())
                                        </label>

                                    </div>
                                }
                            </div>
                            @*<div class="col-lg-12"><span style="float:right;">For CSC Connect :- <a href="~/Content/PDF/csc_guidelines.pdf" target="_blank" style="color:blue; text-decoration:underline;">Guidelines</a></span></div>*@
                            <div class="clearfix"></div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 p10">


                                <div class="form-group">

                                    <label class="manadatory col-lg-3 rbt-grp" for="lblUserType" style="padding-left:0;">
                                        User Type
                                    </label>
                                    <label class="col-lg-9" for="rbtYes" style="padding:0;">
                                        @*<script src="~/Scripts/cscconnect.js"></script>*@
                                        @*<input type="submit" id="btnCSC" name="CSCsubmit" class="btn-success pull-right" value="Login with Digital Seva Connect" />*@
                                        @*<a href="@ViewBag.SevaURL" target="_self" id="aDigitalSeva" class="btn-success pull-right">Login with Digital Seva Connect</a>*@

                                        <input type="radio" ID="UserType" name="UserType" value="Citizen" class="mleft40" />Student
                                        &nbsp;&nbsp;
                                        @*<input type="radio" ID="UserType" name="UserType" value="Kiosk" required /> CSC<br />*@
                                        &nbsp;&nbsp;
                                        <input type="radio" ID="UserType" name="UserType" value="G2G" class="mleft40" />Department

                                    </label>
                                </div>
                                <br />
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <div class="form-group">
                                    <label class="manadatory" for="UserName">
                                        Login ID
                                    </label>
                                    <input type="text" class="form-control" placeholder="Enter User Login ID" name="LoginID" id="LoginID" maxlength="25" autocomplete="off" readonly onfocus="this.removeAttribute('readonly');" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <div class="form-group">
                                    <label class="manadatory" for="Password">
                                        Password
                                    </label>
                                    <input type="password" class="form-control" placeholder="Enter Password" name="Password" id="Password" maxlength="20" autocomplete="off" readonly onfocus="this.removeAttribute('readonly');" />
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                <label class="manadatory" for="Village">
                                    Verification Code
                                </label>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-7">
                                
                               <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6 pleft0 text-left">

                                    <img src='@Url.Action("GetCaptcha")' alt="verification code" class=".gov.inform-control" id="captchaImage" />
                                    <a id="btnrefresh" onclick="GenerateCaptcha();">
                                        <i class="fa fa-refresh"></i>
                                    </a>
                                </div>
                            </div>
                           
                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-5">
                                    <div>
                                        <input type="text" class="form-control" placeholder="Enter Verification Code" name="captcha" id="captcha" maxlength="6" />
                                    </div>
                                </div>

                                <div class="clearfix"></div>


                                @*<div class="col-xs-7">
                <b><span style="margin-top: 0;"><a href="~/WebApp/Registration/CitizenRegistration.aspx?SvcID=995" target="_blank" class="btn btn-primary">Citizen Registration >></a></span></b>
            </div>*@
                                <div class="col-xs-8 mtop15 text-left mbtm10">
                                    @*<a class="btn-link frdgetPwd"  href='~/WebApp/Login/NewForgetPassword.aspx'>Forgot Login ID/Password?</a>
                <a class="btn-link frdgetPwd" href="#" onclick="javascript: return RedirectToForgetPassword()">Forgot Login ID/Password?</a>
                <br />*@
                                    @*<a class="btn-link" href='#' data-toggle="modal" data-target="#CitizenReg">Citizen Registeration</a>*@
                                </div>
                                <div class="mtop10"></div>
                                <div class="col-xs-4 ">
                                    <input type="submit" id="btnlogin" name="CSCsubmit" class="btn-success pull-right" value="Login" onclick="javascript: return submitForm()" />
                                </div>
                                <br />
                                <div class="clearfix"></div>
                                <div class="mtop10"></div>
                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="margin:0 auto; text-align:center;"><a href="#" id="backuser" style="color:#b71c1c; text-decoration:underline;"><i class="fa fa-arrow-circle-left pright5"></i>BACK TO PAGE</a></div>
                                <div class="clearfix"></div>
                            </div>

                        </div>
                </div>
                <div class="clearfix"></div>
            </div>
        </section>
        @*<footer id="bottom">
                <div class="row ptop15 pbottom15">

                    <div class="col-lg-8 col-xs-12">
                        <nav class="bottomnavbar">
                            <ul>
                                <li><a href="#">Disclaimer and Policies</a></li>
                                <li><a href="../forms/sitemap.aspx">Sitemap</a></li>
                                <li><a href="#">Terms and Condition</a></li>
                                <li><a target="_blank" href="/g2c/forms/CenterList.aspx">List of CSC Centers in Odisha</a></li>
                            </ul>


                        </nav>
                        <asp:Label ID="TotalVisitor" runat="server" CssClass="tvstor"></asp:Label>
                        <asp:Label ID="TodayVisitor" runat="server" CssClass="tdyvstor"></asp:Label>
                        <div class="clearfix"></div>
                        <p class="pleft15 ptop15">
                            Technology Partner, CSC SPV. <br />
                            Contents on this website is owned, updated and managed by the CMGI. © 2016
                        </p>
                    </div>
                    <div class="col-lg-4 col-sm-4 col-xs-12 btm_logo">
                        <a href="https://validator.w3.org/" target="_blank"><img src="/g2c/img/w3c_html_validationIcon.png" alt="W3C Html Validate" class="img-responsive inline-block" /></a>
                        <a href="https://jigsaw.w3.org/css-validator/" target="_blank"> <img src="/g2c/img/w3c_css_validate.gif" alt="W3C CSS Validate" /></a>
                        <img src="/g2c/img/btm_cmgi_logo.png" alt="CMGI LOGO" class="img-responsive inline-block" />
                        <img src="/g2c/img/csc_logo.png" alt="" class="img-responsive inline-block" />
                    </div>
                </div>
            </footer>*@

        @*@Html.Partial("~/Areas/Portal/Views/Shared/_CitizenRegistration.cshtml")*@

        <div class="clearfix"></div>

        <script src="~/g2c/js/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $("#btncscConnect").on("click", function (e) {
                    $('#btnCSC').trigger('submit');
                    $("#loginForm").submit();
                });
            });
            $('body').keypress(function (e) {
                if (e.which === 13) {
                    e.preventDefault();
                    //  alert('hi');
                    $("input[value='Login']").trigger('click');
                }
            });
            //function keypressHandler(e) {
            //    if (e.which == 13) {
            //        e.preventDefault(); //stops default action: submitting form
            //        $(this).blur();
            //        $('#SubmitButton').focus().click();//give your submit an ID
            //    }
            //}

            //$('#loginForm').keypress(keypressHandler);

            //$(document).ready(function () {
            //    $('#btnLogin').click(function () {
            //        if ($('#Password').val() != "") {
            //            var seed = $('#hdrandomSeed');
            //            return md5auth(seed.val());
            //        }
            //        $("#loginForm").submit();
            //    });
            //});

            function md5auth(seed) {
                var password1 = $('#Password');
                var password = password1.val();
                var hash = calcMD5(seed + calcMD5(password).toUpperCase());
                password1.val(hash.toUpperCase());
                return true;
            }

            function submitForm() {
                var UserName = document.getElementById("LoginID");
                var Pass = document.getElementById("Password");
                var Captcha = document.getElementById("captcha");
                var skv = document.getElementById("hdnsaltkey");

                //var UserType = document.getElementById("UserType");

                //if (!UserType.checked) {
                //    alert("* Please select User Type.");
                //    return false;
                //}

                var r = document.getElementsByName("UserType");
                var c = -1;

                for (var i = 0; i < r.length; i++) {
                    if (r[i].checked) {
                        c = i;
                    }
                }
                if (c == -1) {
                    alert("* Please select User Type.");
                    return false;
                }

                if (UserName.value == null || UserName.value == "") {
                    alert("* Please enter the Login Id.");
                    return false;
                }

                if (Pass.value == null || Pass.value == "") {
                    alert("* Please enter the Password.");
                    return false;
                }
                if (Captcha.value == null || Captcha.value == "") {
                    alert("* Please enter the Verification Code.");
                    return false;
                }





                /*
                var strSaltKey = skv.value;

                var strPW = hex_hmac_md5(Pass.value, '');

                // alert(strPW);
                //  Pass.value = strPW;
                Pass.value = hex_hmac_md5(strPW, strSaltKey);
                */

                //if ($('#Password').val() != "") {
                //    var seed = $('#hdrandomSeed');
                //    return md5auth(seed.val());
                //}

                //debugger;

                //var strhiden = calcMD5($('#hdrandomSeed').val());
                //var pwd1 = $('#Password').val();
                //var pwd1 = pwd1;
                //pwd1 = calcMD5(pwd1);


                //var encipt1 = calcMD5(pwd1 + strhiden);
                //$('#Password').val(encipt1);

                debugger;

                var strhiden = sha256_digest(salt);
                var pwd1 = $('#Password').val();
                var pwd1 = pwd1;
                pwd1 = sha256_digest(pwd1);


                //var encipt1 = sha256_digest(pwd1.toLowerCase() + strhiden.toLowerCase());
                var encipt1 = pwd1.toLowerCase();
                $('#Password').val(encipt1);

                // var encipt1 = calcMD5(pwd1 + strhiden);
                //document.getElementById("txt_pass").maxLength = encipt1.length;
                //document.getElementById("txt_pass").value = encipt1;
                //var strhiden = $('#hdrandomSeed').val();
                //var pwd1 = $('#Password').val();
                //var pwd1 = pwd1;
                //pwd1 = calcMD5(pwd1);

                //var encipt1 = calcMD5(strhiden + pwd1.toUpperCase());
                //$('#Password').val(encipt1);

                //var newpassword = Pass.value;

                //var newHash = calcMD5(strSaltKey + (calcMD5(newpassword).toUpperCase()));
                //Pass.value = newHash;


                //var seed = $('#hdrandomSeed');
                //return md5auth(seed.val());

                $('#hdrDigitalSevaDigitalSeva').val("0");


                return true;
            }

            function RedirectToForgetPassword() {
                var rtnurl = "";
                debugger;
                var Type = $("input:radio[name='UserType']:checked").val();
                rtnurl = "/WebApp/Login/NewForgetPassword.aspx?Type=" + Type;
                window.location.href = rtnurl;
                return;
            }

            function RedirectToDigitalSeva() {
                $('#hdrDigitalSeva').val("1");
            }

            function DispLoginPanel(Type) {

                $('#allUserType').hide();
                $('#showLogin').show();

                if (Type == "C") {
                    $("input[name='UserType'][value='Citizen']").prop("checked", true);

                }

                if (Type == "D") {
                    $("input[name='UserType'][value='G2G']").prop("checked", true);

                }
                if (Type == "CSC") {
                    debugger;
                    // $(document.getElementById("#btnCSC")).trigger("click");
                    //jQuery('.web').click(function () {
                    //$(document.getElementById("#loginForm")).submit();
                    //alert('alert');
                    //$("input[name='CSCsubmit'][value='Login with Digital Seva Connect']").click();
                    //$("#btnCSC").trigger("click");
                    //var form = $("#CSCsubmit")[0];
                    //console.log(form.submit);
                    //$("#CSCsubmit").click();
                }

            }


            function GenerateCaptcha() {

                var _randomNumber = randomNumber(100000, 999999);
                $("#captchaImage").attr("src", "GetCaptcha?ver=" + parseInt(_randomNumber));
            }
        
         
            function randomNumber(min, max) {
                return Math.random() * (max - min) + min;
            }
        </script>
        <!-- Bootstrap core JavaScript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="~/Sambalpur/js/jquery-2.2.3.min.js"></script>
        <script>window.jQuery || document.write('<script src="~/g2c/js/jquery-2.2.3.min.js"><\/script>')</script>
        <script src="~/Sambalpur/js/bootstrap.min.js"></script>

        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="~/Sambalpur/js/ie10-viewport-bug-workaround.js"></script>
    </form>
</body>
